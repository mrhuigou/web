/**
 * Created by StandOpen on 16/9/13.
 */

var zhqdapp = function(){
    var u = navigator.userAgent;
    var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1;
    if(isAndroid)
    {
        this.type = "android";
    }
    else
    {
        this.type = "ios";
    }

}

zhqdapp.prototype.Toast = function(msg)
{
    msg = Base64.encode(msg)
    if(this.type == "android")
    {
        zhqd.Toast(msg);
    }
    else
    {
        var url = "zhqd://toast?json="+msg;
        window.location.href=url;
    }
}

zhqdapp.prototype.previewImages = function(images,index)
{
    var json = '[';
    for(var i=0;i<images.length;i++)
    {
        var imgUrl = images[i];
        if(imgUrl.indexOf('http') == -1)
        {
            imgUrl += "http://" + window.host + imgUrl;
        }


        json += '"'+images[i]+'"';
        if(i < images.length-1)
        {
            json += ',';
        }
    }
    json += "]";

    strJson = Base64.encode(json);

    if(this.type == "android")
    {
        zhqd.previewImages(strJson,index);
    }
    else
    {
        var url = "zhqd://previewImages?json="+strJson+"&index="+index;
        window.location.href=url;
    }

}

zhqdapp.prototype.Share = function(url,title,desc,imgurl)
{
    var strJson = '{"title":"'+title+'","url":"'+url+'","desc":"'+desc+'","imgurl":"' + imgurl + '"}';
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.Share(strJson);
    }
    else
    {
        var url = "zhqd://share?json="+strJson;
        window.location.href = url;
    }
}

zhqdapp.prototype.CloseWin = function()
{
    if(this.type == "android")
    {
        zhqd.CloseWin();
    }
    else
    {
        var url = "zhqd://closewin?json=";
        window.location.href=url;
    }

}

zhqdapp.prototype.openWin = function(title,url)
{
    var strJson = '{"title":"'+title+'","url":"'+url+'"}';
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.openWin(strJson);
    }
    else
    {
        var url = "zhqd://openwin?json="+strJson;
        window.location.href = url;
    }

}

zhqdapp.prototype.replyComment = function(floor_num,floor_id)
{
    var strJson = '{"floor_num":"'+floor_num+'","floor_id":"'+floor_id+'"}';
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.replyComment(strJson);
    }
    else
    {
        var url = "zhqd://replyComment?json="+strJson;
        window.location.href = url;
    }

}

zhqdapp.prototype.login = function()
{
    if(this.type == "android")
    {
        zhqd.login();
    }
    else
    {
        var url = "zhqd://login?json=";
        window.location.href = url;
    }
}

zhqdapp.prototype.doAgree = function(id)
{
    var strJson = '{"posts_id":"'+id+'"}';
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.doAgree(strJson);
    }
    else
    {
        var url = "zhqd://doagree?json="+strJson;
        window.location.href = url;
    }
}

zhqdapp.prototype.openVideo = function(url)
{
    var strJson = '{"url":"'+url+'"}';
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.openVideo(strJson);
    }
    else
    {
        var url = "zhqd://openVideo?json="+strJson;
        window.location.href = url;
    }
}

zhqdapp.prototype.doCollect = function(title,url)
{
    var strJson = '{"title":"'+title+'","url":"'+url+'"}';
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.doCollect(strJson);
    }
    else
    {
        var url = "zhqd://docollect?json="+strJson;
        window.location.href = url;
    }
}


zhqdapp.prototype.addPost = function(type_id,topic_id)
{
    var strJson = '{"type_id":"'+type_id+'","topic_id":"'+topic_id+'"}';
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.addPost(strJson);
    }
    else
    {
        var url = "zhqd://addpost?json="+strJson;
        window.location.href = url;
    }
}

zhqdapp.prototype.doMission = function(mis_id)
{
    var strJson = '{"mis_id":"'+mis_id+'"}';
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.doMission(strJson);
    }
    else
    {
        var url = "zhqd://domission?json="+strJson;
        window.location.href = url;
    }
}

zhqdapp.prototype.doPay = function (strJson) {
    strJson = Base64.encode(strJson);
    if(this.type == "android")
    {
        zhqd.doPay(strJson);
    }
    else
    {
        var url = "zhqd://dopay?json="+strJson;
        window.location.href = url;
    }
}

var app = new zhqdapp();